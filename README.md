# Tally Prime Bulk Data Import Tool

A comprehensive Python-based tool to import bulk data into Tally Prime through Excel files. This tool converts Excel data to Tally-compatible XML format without requiring any APIs.

## 🚀 Features

- **Complete Tally Integration**: Supports all major Tally modules (Sales, Purchase, Ledgers, Stock Items, Receipts, Payments)
- **Excel-Based Workflow**: Simple Excel templates for data entry
- **XML Generation**: Converts Excel data to Tally-compatible XML format
- **Multi-line Support**: Handles complex vouchers with multiple line items
- **GST Compliance**: Automatic GST calculations and tax handling
- **User-Friendly GUI**: Intuitive interface for easy operation
- **No API Required**: Works offline, generates files for direct import

## 📋 Requirements

- Python 3.7 or higher
- Tally Prime (any version)
- Microsoft Excel or compatible software

## 🛠️ Installation

1. **Clone or download this repository**
```bash
git clone <repository-url>
cd tally-bulk-importer
```

2. **Install required packages**
```bash
pip install -r requirements.txt
```

3. **Run the tool**
```bash
python tally_bulk_importer.py
```

## 📖 How to Use

### Step 1: Download Templates
1. Launch the tool
2. Navigate to the appropriate tab (Masters Data or Transaction Vouchers)
3. Click "Download [Type] Template" to get Excel templates
4. Templates will be saved in the `templates/` folder

### Step 2: Fill Your Data
1. Open the downloaded Excel template
2. Replace sample data with your actual data
3. Follow column headers exactly as provided
4. Save the file after entering your data

### Step 3: Convert to XML
1. Click "Convert [Type] to XML" button
2. Select your filled Excel file
3. Tool generates XML file in the `output/` folder

### Step 4: Import into Tally Prime
1. Open Tally Prime
2. Go to **Gateway of Tally > Import Data**
3. Select **Masters** or **Vouchers** based on your data type
4. Choose the XML file generated by this tool
5. Review and confirm the import

## 📊 Supported Data Types

### Master Data
- **Ledgers**: Customer, Supplier, and Account ledgers with GST details
- **Stock Items**: Products with pricing, tax rates, and opening stock

### Transaction Vouchers
- **Sales**: Multi-item sales invoices with automatic tax calculations
- **Purchase**: Purchase vouchers with input tax handling
- **Receipt**: Cash/Bank receipt vouchers
- **Payment**: Expense and payment vouchers
- **Journal**: General journal entries (coming soon)

## 📝 Excel Template Format

### Ledger Template
| Name | Group | Alias | Address | Mobile | Email | GSTIN | Opening_Balance |
|------|-------|-------|---------|--------|-------|-------|-----------------|
| ABC Company | Sundry Debtors | | 123 Main St | 9876543210 | abc@company.com | 29ABCDE1234F1Z5 | 25000 |

### Sales Template
| Voucher_No | Date | Party_Name | Sales_Ledger | Item_Name | Quantity | Rate | GST_Rate | Ref_No | Ref_Date |
|------------|------|------------|--------------|-----------|----------|------|----------|--------|----------|
| S001 | 01/04/2024 | ABC Company | Sales | Product A | 2 | 1000 | 18 | REF001 | 01/04/2024 |

### Stock Items Template
| Name | Alias | Group | Category | Unit | HSN_Code | GST_Rate | Opening_Quantity | Opening_Rate |
|------|-------|-------|----------|------|----------|----------|------------------|--------------|
| Product A | PROD-A | Primary | Primary | Nos | 1234 | 18 | 100 | 1000 |

## ⚙️ Configuration

### Date Formats Supported
- DD/MM/YYYY (e.g., 31/12/2024)
- DD-MM-YYYY (e.g., 31-12-2024)
- YYYY-MM-DD (e.g., 2024-12-31)
- MM/DD/YYYY (e.g., 12/31/2024)

### Important Notes
- **GST Rates**: Enter as percentage (18 for 18%)
- **Amounts**: Enter without currency symbols
- **Voucher Numbers**: Must be unique
- **Party Names**: Must match ledger names exactly
- **Backup**: Always backup Tally data before importing

## 🔧 Troubleshooting

### Common Issues

1. **Import Fails in Tally**
   - Check if required ledgers exist in Tally
   - Verify party names match exactly
   - Ensure date formats are correct

2. **XML Generation Error**
   - Check Excel file format (.xlsx preferred)
   - Verify all required columns are present
   - Remove any merged cells or formatting

3. **GST Calculation Issues**
   - Ensure GST rates are in percentage format
   - Check if CGST/SGST ledgers exist in Tally
   - Verify HSN codes are correct

### Error Messages
- **"Required column missing"**: Add the missing column to your Excel file
- **"Invalid date format"**: Use supported date formats
- **"Duplicate voucher number"**: Ensure voucher numbers are unique

## 📁 File Structure

```
tally-bulk-importer/
├── tally_bulk_importer.py    # Main application
├── requirements.txt          # Python dependencies
├── README.md                # This file
├── templates/               # Generated Excel templates
│   ├── Ledger_Template.xlsx
│   ├── Sales_Template.xlsx
│   └── ...
└── output/                  # Generated XML files
    ├── sales_20241201_143022.xml
    └── ...
```

## 🆘 Support

### Before Importing
- Create a backup of your Tally company data
- Test with a small dataset first
- Ensure all required master data exists

### Technical Support
- Check the help tab in the application
- Review error messages carefully
- Verify Excel file structure matches templates

## 🔄 Updates and Versions

- **Current Version**: 1.0
- **Tally Compatibility**: Tally Prime (all versions), Tally ERP 9
- **Python Compatibility**: 3.7+

## 📄 License

This tool is provided as-is for educational and business use. Please test thoroughly before using in production environments.

## 🤝 Contributing

Contributions are welcome! Please feel free to submit issues or pull requests to improve the tool.

---

**Note**: This tool generates XML files for import into Tally Prime. It does not require any Tally APIs or direct database access, making it safe and compatible with all Tally versions.
